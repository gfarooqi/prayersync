                    <div class="search-input-wrapper">
                        <input type="text" id="locationSearch" placeholder="Enter city name..." autocomplete="off">
                        <div class="search-suggestions" id="searchSuggestions"></div>
                    </div>
                </div>

                <!-- Recent Locations -->
                <div class="recent-locations" id="recentLocations" style="display: none;">
                    <h3>Recent Locations</h3>
                    <div class="recent-list" id="recentList">
                        <!-- Recent locations will be populated here -->
                    </div>
                </div>

                <!-- Popular Cities -->
                <div class="popular-cities">
                    <h3>Popular Cities</h3>
                    <div class="city-grid">
                        <button type="button" class="city-btn" onclick="selectCity('Mecca', 'Saudi Arabia', 21.4225, 39.8262, 'Asia/Riyadh')">
                            Mecca
                        </button>
                        <button type="button" class="city-btn" onclick="selectCity('Medina', 'Saudi Arabia', 24.5247, 39.5692, 'Asia/Riyadh')">
                            Medina
                        </button>
                        <button type="button" class="city-btn" onclick="selectCity('Istanbul', 'Turkey', 41.0082, 28.9784, 'Europe/Istanbul')">
                            Istanbul
                        </button>
                        <button type="button" class="city-btn" onclick="selectCity('Cairo', 'Egypt', 30.0444, 31.2357, 'Africa/Cairo')">
                            Cairo
                        </button>
                        <button type="button" class="city-btn" onclick="selectCity('Dubai', 'UAE', 25.2048, 55.2708, 'Asia/Dubai')">
                            Dubai
                        </button>
                        <button type="button" class="city-btn" onclick="selectCity('London', 'UK', 51.5074, -0.1278, 'Europe/London')">
                            London
                        </button>
                        <button type="button" class="city-btn" onclick="selectCity('New York', 'USA', 40.7128, -74.0060, 'America/New_York')">
                            New York
                        </button>
                        <button type="button" class="city-btn" onclick="selectCity('Kuala Lumpur', 'Malaysia', 3.1390, 101.6869, 'Asia/Kuala_Lumpur')">
                            Kuala Lumpur
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Modal -->
    <div class="modal" id="errorModal" style="display: none;">
        <div class="modal-content error-modal">
            <div class="modal-header">
                <h2>⚠️ Error</h2>
                <button type="button" class="modal-close" onclick="closeErrorModal()">&times;</button>
            </div>
            <div class="error-content">
                <p id="errorMessage">An error occurred. Please try again.</p>
                <div class="error-actions">
                    <button type="button" class="btn-primary" onclick="closeErrorModal()">OK</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="app-production.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(registration => {
                        console.log('ServiceWorker registered successfully');
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>

    <!-- Global Functions for Modal Management -->
    <script>
        // Location Modal Functions
        function openLocationModal() {
            document.getElementById('locationModal').style.display = 'flex';
            if (app && app.updateRecentLocationsUI) {
                app.updateRecentLocationsUI();
            }
        }

        function closeLocationModal() {
            document.getElementById('locationModal').style.display = 'none';
            const suggestions = document.getElementById('searchSuggestions');
            if (suggestions) suggestions.classList.remove('show');
        }

        function useCurrentLocation() {
            closeLocationModal();
            if (app && app.getLocation) {
                app.getLocation();
            }
        }

        function selectCity(name, country, lat, lon, timezone) {
            if (app && app.setLocation) {
                app.setLocation({
                    name: name,
                    country: country,
                    latitude: lat,
                    longitude: lon,
                    timezone: timezone
                });
            }
            closeLocationModal();
        }

        function selectSearchResult(name, country, lat, lon) {
            const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            
            if (app && app.setLocation) {
                app.setLocation({
                    name: name,
                    country: country,
                    latitude: parseFloat(lat),
                    longitude: parseFloat(lon),
                    timezone: timezone
                });
            }
            closeLocationModal();
        }

        function selectRecentLocation(name, country, lat, lon, timezone) {
            if (app && app.setLocation) {
                app.setLocation({
                    name: name,
                    country: country,
                    latitude: parseFloat(lat),
                    longitude: parseFloat(lon),
                    timezone: timezone
                }, false); // Don't add to recent again
            }
            closeLocationModal();
        }

        // Error Modal Functions
        function showErrorModal(message) {
            document.getElementById('errorMessage').textContent = message;
            document.getElementById('errorModal').style.display = 'flex';
        }

        function closeErrorModal() {
            document.getElementById('errorModal').style.display = 'none';
        }

        // Export Functions
        function exportToday() {
            if (app && app.exportCalendar) {
                app.exportCalendar('today');
            }
        }

        function exportWeek() {
            if (app && app.exportCalendar) {
                app.exportCalendar('week');
            }
        }

        function exportMonth() {
            if (app && app.exportCalendar) {
                app.exportCalendar('month');
            }
        }

        // Close modal when clicking outside
        document.addEventListener('click', (e) => {
            const modals = ['locationModal', 'errorModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });

        // Hide loading screen when app loads
        window.addEventListener('load', () => {
            setTimeout(() => {
                const loadingScreen = document.getElementById('loadingScreen');
                if (loadingScreen) {
                    loadingScreen.style.opacity = '0';
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                    }, 300);
                }
            }, 1000);
        });

        // Handle network status
        window.addEventListener('online', () => {
            console.log('Network connection restored');
        });

        window.addEventListener('offline', () => {
            console.log('Network connection lost - using offline mode');
        });
    </script>

    <!-- Analytics and Performance Monitoring -->
    <script>
        // Performance monitoring
        window.addEventListener('load', () => {
            // Measure performance
            if ('performance' in window) {
                const perfData = performance.getEntriesByType('navigation')[0];
                console.log('Page load time:', perfData.loadEventEnd - perfData.loadEventStart, 'ms');
            }
        });

        // Error tracking
        window.addEventListener('error', (e) => {
            console.error('Global error:', e.error);
            // In production, send to error tracking service
        });

        window.addEventListener('unhandledrejection', (e) => {
            console.error('Unhandled promise rejection:', e.reason);
            // In production, send to error tracking service
        });
    </script>

    <!-- SEO and Accessibility Enhancements -->
    <noscript>
        <div style="padding: 2rem; text-align: center; background: #f5f5f5;">
            <h2>JavaScript Required</h2>
            <p>PrayerSync requires JavaScript to function properly. Please enable JavaScript in your browser settings.</p>
            <p>For prayer times without JavaScript, visit: <a href="https://aladhan.com">Aladhan.com</a></p>
        </div>
    </noscript>
</body>
</html>